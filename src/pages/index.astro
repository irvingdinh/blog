---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";

const posts = await getCollection("posts");
const articles = await getCollection("articles", ({ data }) => !data.draft);

const sortedPosts = posts.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);
const sortedArticles = articles.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);
---

<Layout title="Blog">
  <h1 class="text-3xl font-bold mb-6">Blog</h1>

  <h2 class="text-xl font-semibold mt-8 mb-4">Articles</h2>
  {
    sortedArticles.length === 0 ? (
      <p>No articles yet.</p>
    ) : (
      <ul class="list-disc pl-5 space-y-2">
        {sortedArticles.map((article) => (
          <li>
            <a class="text-blue-600 hover:underline" href={`/articles/${article.id.replace(/\/index$/, "")}`}>
              {article.data.title}
            </a>
            <span class="text-gray-600"> - {article.data.date.toLocaleDateString()}</span>
          </li>
        ))}
      </ul>
    )
  }

  <h2 class="text-xl font-semibold mt-8 mb-4">Posts</h2>
  {
    sortedPosts.length === 0 ? (
      <p>No posts yet.</p>
    ) : (
      <ul class="list-disc pl-5 space-y-2">
        {sortedPosts.map((post) => (
          <li>
            <a class="text-blue-600 hover:underline" href={`/posts/${post.id.replace(/\/index$/, "")}`}>
              {post.data.title || post.id.replace(/\/index$/, "")}
            </a>
            <span class="text-gray-600"> - {post.data.date.toLocaleString()}</span>
          </li>
        ))}
      </ul>
    )
  }
</Layout>
