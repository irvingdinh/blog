---
import type { CollectionEntry } from "astro:content";
import type { AstroComponentFactory } from "astro/runtime/server/index.js";
import { AUTHOR } from "../site";
import { formatDateYMD } from "../utils/date";

interface Props {
  post: CollectionEntry<"posts">;
  Content: AstroComponentFactory;
}

const { post, Content } = Astro.props;
const permalink = `/post/${post.id.replace(/\/index$/, "")}/`;
---

<article
  class="rounded-2xl border border-zinc-200 bg-white p-6 shadow-sm dark:border-zinc-800 dark:bg-zinc-950/40 dark:shadow-none
    transition duration-200
    motion-safe:hover:-translate-y-0.5 motion-safe:hover:shadow-md hover:border-zinc-300
    dark:hover:border-zinc-700
    focus-within:ring-2 focus-within:ring-blue-500/20 focus-within:ring-offset-2 focus-within:ring-offset-zinc-50
    dark:focus-within:ring-offset-zinc-950"
>
  <header class="flex items-center gap-3">
    <!-- Placeholder avatar (replace later) -->
    <div
      class="h-10 w-10 shrink-0 rounded-full bg-zinc-200 text-zinc-700 dark:bg-zinc-800 dark:text-zinc-200 grid place-items-center font-semibold"
      aria-hidden="true"
    >
      {AUTHOR.initials}
    </div>

    <div class="min-w-0 leading-tight">
      <div class="flex items-baseline gap-2 min-w-0">
        <div class="font-semibold truncate">{AUTHOR.name}</div>
        <div class="text-sm text-zinc-500 dark:text-zinc-400 truncate">
          {AUTHOR.handle}
        </div>
      </div>
      <a
        href={permalink}
        class="text-sm text-zinc-500 dark:text-zinc-400 hover:underline"
      >
        <time datetime={post.data.date.toISOString()}>
          {formatDateYMD(post.data.date)}
        </time>
      </a>
    </div>
  </header>

  <div class="mt-5 prose max-w-none dark:prose-invert">
    <Content />
  </div>

  <footer class="mt-5 flex items-center gap-4 text-sm text-zinc-500 dark:text-zinc-400">
    <a
      href={permalink}
      data-permalink
      class="hover:text-zinc-700 dark:hover:text-zinc-200 hover:underline"
    >
      Permalink
    </a>
    <button
      type="button"
      data-copy-link
      class="hover:text-zinc-700 dark:hover:text-zinc-200 hover:underline"
    >
      Copy link
    </button>
  </footer>
</article>
